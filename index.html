<!DOCTYPE html>
<html>

<head>
    <title>User Profile</title>
    <script src="https://form.jotform.com/static/feedback2.js" type="text/javascript"></script>
    <script type="text/javascript">
        var JFL_232924255172051 = new JotformFeedback({
            formId: '232924255172051',
            base: 'https://form.jotform.com/',
            windowTitle: 'Form',
            backgroundColor: '#FFA500',
            fontColor: '#FFFFFF',
            type: 'false',
            height: 500,
            width: 700,
            openOnLoad: false
        });

        var quizCompleted = false;  // A flag to track if the quiz is completed

        // Function to display the test score
        function displayTestScore(score) {
            var tfiScoreElement = document.getElementById('tfiScore');
            tfiScoreElement.innerText = 'Your TFI Score: ' + score;

            // Remove the "Take the Quiz" button
            var takeQuizButton = document.getElementById('takeQuiz');
            takeQuizButton.style.display = 'none';
        }

        // Function to handle the completion of the quiz
        function onQuizCompletion(score) {
            displayTestScore(score);
            quizCompleted = true;
        }

        // Add an event listener to open the quiz lightbox
        document.getElementById('takeQuiz').addEventListener('click', function () {
            // Display the quiz lightbox when the "Take the Quiz" button is clicked
            JFL_232924255172051.open();
        });

        // Add an event listener for messages received from the quiz
        window.addEventListener("message", function (e) {
            var messageData = e.data;
            if (messageData.type === 'quizCompletion' && !quizCompleted) {
                // Handle quiz completion and display the score
                onQuizCompletion(messageData.score);
            }
        });
    </script>
</head>

<body>
    <h1>Welcome, <span id="username">JohnDoe</span></h1>

    <!-- Tinnitus Story -->
    <div class="tinnitus-story">
        <p>Share your tinnitus story</p>
        <textarea id="tinnitusStory" rows="5" cols="40" placeholder="My tinnitus started when..."></textarea>
        <button id="submitStory">Submit</button>
    </div>

    <!-- TFI Score -->
    <div class="tfi-score">
        <p>Your TFI Score: <span id="tfiScore">Not available</span></p>
        <button id="takeQuiz">Take the Quiz</button>
    </div>
</body>

</html>
